<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>ParetoCalc - Login & Registrierung</title>
  <!-- Meta optional -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- ================== BEGIN ColorAdmin CSS ================== -->
  <!-- 1) vendor.min.css enthält Bootstrap + externe Abhängigkeiten -->
  <link rel="stylesheet" href="/static/coloradmin/css/vendor.min.css" />
  <!-- 2) app.min.css enthält das Haupt-Layout von ColorAdmin -->
  <link rel="stylesheet" href="/static/coloradmin/css/app.min.css" />
  <!-- ================== END ColorAdmin CSS ================== -->

  <!-- Optional: Dein eigenes Custom CSS -->
  <!-- <link rel="stylesheet" href="/static/css/my-custom.css" /> -->

</head>
<body class="pace-top">
  <!-- Loader-Element (optional) -->
  <div id="loader" class="app-loader">
    <span class="spinner"></span>
  </div>

  <!-- BEGIN #app -->
  <div id="app" class="app">

    <!-- BEGIN .login.login-v2 -->
    <div class="login login-v2 fw-bold">

      <!-- BEGIN login-cover (Hintergrundbild) -->
      <div class="login-cover">
        <!-- Anpassen: Bild liegt in /static/coloradmin/img/login-bg/ -->
        <div class="login-cover-img"
             style="background-image: url('/static/coloradmin/img/login-bg-17.jpg');"
             data-id="login-cover-image">
        </div>
        <div class="login-cover-bg"></div>
      </div>
      <!-- END login-cover -->

      <!-- BEGIN login-container -->
      <div class="login-container">

        <!-- BEGIN login-header -->
        <div class="login-header">
          <div class="brand">
            <div class="d-flex align-items-center">
              <!-- Hier könnte ein Logo hin, z. B. <img src="..." alt="Logo"> -->
              <span class="logo"></span>
              <b>ParetoCalc</b>
            </div>
            <small>Das ultimative B2B-Kalkulationstool</small>
          </div>
          <div class="icon">
            <i class="fa fa-lock"></i>
          </div>
        </div>
        <!-- END login-header -->

        <!-- BEGIN login-content -->
        <div class="login-content">

          <!-- ANMELDEN -->
          <h4 class="mb-3">Anmelden</h4>
          <div class="form-floating mb-20px">
            <input type="text"
                   class="form-control fs-13px h-45px border-0"
                   placeholder="E-Mail"
                   id="loginEmail" />
            <label for="loginEmail" class="d-flex align-items-center text-gray-600 fs-13px">
              E-Mail-Adresse
            </label>
          </div>
          <div class="form-floating mb-20px">
            <input type="password"
                   class="form-control fs-13px h-45px border-0"
                   placeholder="Passwort"
                   id="loginPass" />
            <label for="loginPass" class="d-flex align-items-center text-gray-600 fs-13px">
              Passwort
            </label>
          </div>
          <div class="mb-20px">
            <button type="button"
                    class="btn btn-theme d-block w-100 h-45px btn-lg"
                    onclick="onLogin()">
              Einloggen
            </button>
          </div>

          <hr />

          <!-- REGISTRIEREN -->
          <h4 class="mb-3">Neu hier? Jetzt registrieren</h4>
          <div class="form-floating mb-20px">
            <input type="text"
                   class="form-control fs-13px h-45px border-0"
                   placeholder="E-Mail"
                   id="regEmail" />
            <label for="regEmail" class="d-flex align-items-center text-gray-600 fs-13px">
              E-Mail-Adresse
            </label>
          </div>
          <div class="form-floating mb-20px">
            <input type="password"
                   class="form-control fs-13px h-45px border-0"
                   placeholder="Passwort"
                   id="regPass" />
            <label for="regPass" class="d-flex align-items-center text-gray-600 fs-13px">
              Passwort
            </label>
          </div>
          <div class="mb-20px">
            <button type="button"
                    class="btn btn-info d-block w-100 h-45px btn-lg"
                    onclick="onRegister()">
              Registrieren
            </button>
          </div>

        </div>
        <!-- END login-content -->

      </div>
      <!-- END login-container -->

    </div>
    <!-- END .login.login-v2 -->

    <!-- OPTIONAL: Hintergrundbilder-Wechsler (Login BG List) -->

  </div>
  <!-- END #app -->

  <!-- ================== BEGIN ColorAdmin JS ================== -->
  <!-- vendor.min.js -> enthält jQuery, Bootstrap JS, etc. -->
  <script src="/static/coloradmin/js/vendor.min.js"></script>
  <!-- app.min.js -> enthält das Grund-Skript von ColorAdmin -->
  <script src="/static/coloradmin/js/app.min.js"></script>
  <!-- login-v2.demo.js -> nur wenn du den Wechsel der Hintergrundbilder willst -->

  <!-- ================== END ColorAdmin JS ================== -->

  <!-- Deine Login-/Register-Logik -->
  <script>
  async function onLogin() {
    const email = document.getElementById("loginEmail").value.trim();
    const password = document.getElementById("loginPass").value.trim();
    if(!email || !password){
      alert("Bitte Email/Passwort eingeben!");
      return;
    }
    try {
      const res = await fetch("/auth/login", {
        method:"POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ email, password })
      });
      const data = await res.json();
      if(data.error) {
        alert("Fehler: " + data.error);
      } else {
        alert("Login ok: " + data.license);
        window.location="/mycalc/"; // oder /upgrade
      }
    } catch(err) {
      console.error(err);
      alert("Login fehlgeschlagen!");
    }
  }

  async function onRegister() {
    const email = document.getElementById("regEmail").value.trim();
    const password = document.getElementById("regPass").value.trim();
    if(!email || !password){
      alert("Bitte Email/Passwort eingeben!");
      return;
    }
    try {
      const res = await fetch("/auth/register", {
        method:"POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ email, password })
      });
      const data = await res.json();
      if(data.error){
        alert("Fehler: " + data.error);
      } else {
        alert("Registrierung ok => " + data.message);
        window.location="/upgrade";
      }
    } catch(err) {
      console.error(err);
      alert("Registrierung fehlgeschlagen!");
    }
  }
  </script>
</body>
</html>